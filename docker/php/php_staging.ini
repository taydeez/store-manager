; ==========================================
; Laravel Octane â€” STAGING Optimized PHP Settings
; ==========================================

; -------- Memory & Performance ----------
memory_limit = 512M
max_execution_time = 60
max_input_time = 90

; -------- Upload Limits ----------
upload_max_filesize = 50M
post_max_size = 50M

; -------- Opcache (Required for Octane) --------
opcache.enable = 1
opcache.enable_cli = 1
opcache.memory_consumption = 256
opcache.interned_strings_buffer = 16
opcache.max_accelerated_files = 20000
opcache.validate_timestamps = 1     ; Enable auto-reload for staging
opcache.revalidate_freq = 2
opcache.save_comments = 1
opcache.fast_shutdown = 1

; -------- JIT --------
opcache.jit = tracing
opcache.jit_buffer_size = 128M

; -------- Realpath Cache (Laravel Boost) --------
realpath_cache_size = 4096K
realpath_cache_ttl = 600

; -------- Error Logging ----------
log_errors = 1
error_log = /dev/stderr
display_errors = 1                ; Useful for staging
display_startup_errors = 1

; -------- Sessions --------
session.save_handler = files
session.gc_maxlifetime = 3600

; -------- Extensions ----------
extension = pdo_mysql
extension = redis
extension = bcmath
extension = zip
extension = intl

; -------- Xdebug for Staging (Safe Defaults) --------
xdebug.mode = off              ; Not auto-enabled (prevents slowdown)
xdebug.start_with_request = trigger  ; Enable only when ?XDEBUG_TRIGGER=1
xdebug.client_port = 9003
xdebug.client_host = host.docker.internal
xdebug.discover_client_host = 1

; Optional profiling on-demand
xdebug.output_dir = "/tmp/xdebug"
